#!/usr/bin/env python

import sys
sys.path.append('../..')
from Thinkpol.supervisor import Node
from multiprocessing import cpu_count
import gevent
import signal

CMD = "./worker"

if __name__ == '__main__':
	execfile("config")
	THINKPOL_ADDR = (THINKPOL_ADDR, THINKPOL_PORT) 

	node = Node()
	node.start(CMD, cpu_count())
	node.connect(("localhost", 10000))

	gevent.signal(signal.SIGTERM, node.stop)
	gevent.signal(signal.SIGQUIT, node.stop)
	gevent.signal(signal.SIGINT, node.stop)

	gevent.sleep(100)